# 科创50指数滚动年化波动率分析

本项目通过Tushare金融数据接口获取科创50指数（代码：000688.SH）的日线行情数据，计算其滚动年化波动率，并进行可视化分析，旨在展示市场波动性的变化特征。

## 项目概述

波动率是衡量金融资产价格波动程度的关键指标，对于风险管理和投资决策具有重要意义。本项目以科创50指数为研究对象，计算了30日、60日和180日三个不同时间窗口的滚动年化波动率，并通过图表直观展示其历史走势及统计特征。

## 主要功能与特点

1.  **数据获取**：使用Tushare Pro API自动获取科创50指数自上市以来的日线行情数据。
2.  **数据预处理**：自动转换日期格式、计算日收益率、按时间排序。
3.  **波动率计算**：采用标准金融计算方法，计算滚动窗口下的年化波动率。
    > **年化波动率 = 日收益率标准差 × √252**
4.  **可视化分析**：
    - **主图**：绘制30日、60日、180日年化波动率的时间序列曲线。
    - **统计参考线**：为每条波动率曲线添加其历史数据的20%、80%分位数水平线，用于判断当前波动率所处的历史分位。
    - **最新值标记**：在图表中突出显示各窗口波动率的最新数值。
    - **子图**：展示科创50指数的成交量变化情况。
5.  **结果输出**：将处理后的完整数据（包含原始行情及计算的波动率）保存为Excel文件 (`df.xlsx`)，便于后续使用。

## 技术栈

- **Python 3**
- **核心库**：
    - `pandas`: 数据处理与分析
    - `numpy`: 数值计算
    - `matplotlib`: 数据可视化
    - `tushare`: 金融数据获取
- **环境**: Jupyter Notebook

## 数据来源

- **数据接口**：[Tushare Pro](https://tushare.pro/)
- **标的**：科创50指数 (000688.SH)
- **数据字段**：包含交易日期 (`trade_date`)、开盘价 (`open`)、收盘价 (`close`)、涨跌幅 (`pct_chg`)、成交量 (`vol`) 等。

## 代码结构与流程

1.  **环境配置与数据获取**:
    - 导入必要的库（`pandas`, `numpy`, `matplotlib`, `tushare`）。
    - 配置Tushare Token，初始化数据接口。
    - 获取科创50指数日线行情数据。

2.  **数据预处理**:
    - 将`trade_date`列转换为`datetime`格式。
    - 利用`pct_chg`字段计算日收益率 (`daily_return`)。
    - 按日期升序排列数据。

3.  **计算滚动波动率**:
    - 分别计算30日 (`volatility_30d`)、60日 (`volatility_60d`)、180日 (`volatility_180d`) 的滚动年化波动率。

4.  **数据可视化**:
    - 设置中文字体与图表样式。
    - 创建包含波动率主图和成交量子图的画布。
    - 绘制三条波动率曲线。
    - 循环计算并添加各窗口波动率历史数据的20%、80%分位数参考线及标签。
    - 在曲线末端添加最新值散点标记。
    - 设置标题、图例、坐标轴格式和网格。

5.  **结果保存**:
    - 将包含所有计算结果的DataFrame保存至`df.xlsx`。

## 运行结果示例

最终生成的图表如下所示：
![科创50指数波动率与成交量分析图](最终图表截图描述)

**上图说明**：
- **上部 (波动率分析图)**：展示了三条不同周期的滚动年化波动率曲线。虚线/点线分别为各曲线的20%和80%历史分位线。图例处标注了各波动率的最新值。
- **下部 (成交量分析图)**：展示了科创50指数日成交量的变化趋势。

## 使用说明

1.  克隆本项目到本地。
2.  在`Tushare/Token.xlsx`文件中填入您自己的Tushare Pro Token。
3.  使用Jupyter Notebook或Jupyter Lab打开 `科创50波动率.ipynb` 文件。
4.  按顺序执行所有代码单元，即可重现完整分析过程与图表。

## 注意事项

- 使用前请确保已注册[Tushare Pro](https://tushare.pro/)账号并获取API Token。
- 首次运行时会从网络获取数据，请保持网络连接。
- 可视化图表中的分位数水平线基于已获取的全部历史数据计算。

## 项目价值

- **学习价值**：展示了完整的金融数据分析流程，包括数据获取、清洗、计算和可视化。
- **实用价值**：提供的波动率分析框架可轻松修改用于分析其他股票或指数。
- **分析价值**：多时间窗口波动率与历史分位数的结合，能更立体地评估当前市场的波动状态。
